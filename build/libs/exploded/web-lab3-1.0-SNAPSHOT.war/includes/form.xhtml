<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pth="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:p="http://primefaces.org/ui">
    <h:outputStylesheet name="form.css" library="style"/>
    <h:panelGroup styleClass="hit-form-wrapper" layout="block">
        <h:form id="hit-form">
            <p:commandButton id="canvasHandler"
                             action="#{hitFormBean.handleCanvasClick}"
                             process="@none"
                             update=":hits-table"
                             style="display:none" />
            <h2>HIT</h2>
            <h:panelGroup styleClass="form-content-wrapper" layout="block">
                <h:panelGroup styleClass="input-block" layout="block">
                    <h:panelGroup styleClass="input-wrapper" layout="block">
                        <h:panelGroup layout="block">X:</h:panelGroup>
                        <h:panelGroup styleClass="checkbox-line" layout="block">
                            <ui:repeat value="#{hitFormBean.xList}" var="item">
                                <h:panelGroup styleClass="check-point" layout="block">
                                    <label for="x-input#{item.value}">#{item.value}</label>
                                    <h:selectBooleanCheckbox
                                            id="x-input#{item.value}"
                                            value="#{item.selected}"
                                            styleClass="x-checkbox">
                                        <f:ajax execute="@this" listener="#{hitFormBean.onXChanged}" render="@none" />
                                    </h:selectBooleanCheckbox>
                                </h:panelGroup>
                            </ui:repeat>
                        </h:panelGroup>
                        <h:inputHidden id="xListHidden" />
                        <h:message for="xListHidden" style="color:red; display:block; min-height:1.2em;" />                   </h:panelGroup>
                    <h:panelGroup styleClass="input-wrapper">
                        <label for="y-input">Y:</label>
                        <div>
                            <h:inputText
                                    value="#{hitFormBean.yCoordinate}"
                                    id="y-input"
                                    pth:oninput="updateGlobalValues(#{hitFormBean.getGlobalXAsJs()}, this.value, globalR)"
                                    onblur="this.value = this.value.replace(',', '.');">
                                <f:validator validatorId="yCoordinateValidator" />
                                <f:ajax event="blur" render="y-message" />
                            </h:inputText>
                        </div>
                        <h:message for="y-input" styleClass="y-message" id="y-message" style="color:red; display:block; min-height:1.2em;"/>
                    </h:panelGroup>
                    <h:panelGroup styleClass="input-wrapper radius">
                        <div>R:
                            <h:panelGroup styleClass="r-value" id="r-value">
                                <h:outputText value="#{hitFormBean.radius}" />
                            </h:panelGroup>
                        </div>
                        <div class="buttons-line">
                            <ui:repeat var="r" value="#{hitFormBean.radiusList}">
                                <div class="check-point">
                                    <label for="r-input-#{r.toString().replace('.', '_')}">#{r}</label>
                                    <h:commandLink value="#{r}"
                                                   id="r-input-#{r.toString().replace('.', '_')}"
                                                   onclick="updateGlobalValues('#{hitFormBean.getGlobalXAsJs()}', globalY, '#{r}')"
                                    >
                                        <f:ajax listener="#{hitFormBean.setRadius(r)}"
                                                execute="@this"
                                                render=":hit-form:r-value"
                                        />
                                    </h:commandLink>
                                </div>
                            </ui:repeat>
                        </div>
                    </h:panelGroup>
                </h:panelGroup>
                <h:panelGroup styleClass="input-wrapper">
                    <p:commandButton
                            value="HIT"
                            action="#{hitFormBean.submit}"
                            process="@form"
                            update=":hits-table @form"
                            validateClient="false"

                    />
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </h:panelGroup>
    <h:outputScript>
        function handleXCheckboxEvent(data) {
            if (data.status === 'success') {
                updateGlobalValues(#{hitFormBean.getGlobalXAsJs()}, globalY, globalR);
            }
        }
    </h:outputScript>
</ui:composition>

